import asyncio # –º–Ω–µ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å
import logging # –ø–æ–¥–∫–ª—é—á–∏–ª –∂—É—Ä–Ω–∞–ª –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª

from aiogram import Bot, Dispatcher # Bot ‚Üí ¬´–æ–±—ä–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π —É–º–µ–µ—Ç –≥–æ–≤–æ—Ä–∏—Ç—å —Å Telegram¬ª. Dispatcher ‚Üí ¬´–æ–±—ä–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è¬ª
from aiogram.methods import DeleteWebhook
from aiogram.fsm.storage.memory import MemoryStorage


from app.config import BOT_TOKEN
from app.handlers import router # router ‚Üí ¬´–Ω–∞–±–æ—Ä –ø—Ä–∞–≤–∏–ª: –∫—Ç–æ –Ω–∞ –∫–∞–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç–≤–µ—á–∞–µ—Ç¬ª
from app.db import init_db

# –ù–ê –≠–¢–û–ú –≠–¢–ê–ü–ï –ü–û–î–ì–û–¢–û–í–ò–õ–ò "–î–ï–¢–ê–õ–ò"



logging.basicConfig(level=logging.INFO) # –ü–æ–∫–∞–∑—ã–≤–∞–π —Å–æ–æ–±—â–µ–Ω–∏—è —É—Ä–æ–≤–Ω—è INFO –∏ –≤—ã—à–µ

async def main():
    await init_db()
    bot = Bot(token=BOT_TOKEN) # –°–æ–∑–¥–∞—é –æ–±—ä–µ–∫—Ç bot, –∫–æ—Ç–æ—Ä—ã–π —É–º–µ–µ—Ç: –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è, –ø–æ–ª—É—á–∞—Ç—å –∞–ø–¥–µ–π—Ç—ã, –æ–±—â–∞—Ç—å—Å—è —Å Telegram API. ‚ö†Ô∏è –ó–¥–µ—Å—å –Ω–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Telegram, –ø—Ä–æ—Å—Ç–æ –æ–±—ä–µ–∫—Ç.
    
    dp = Dispatcher(storage=MemoryStorage())
 # –°–æ–∑–¥–∞—é –¥–∏—Å–ø–µ—Ç—á–µ—Ä ‚Äî –æ–Ω –±—É–¥–µ—Ç: –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Å–æ–±—ã—Ç–∏—è, —Ä–µ—à–∞—Ç—å, –∫–∞–∫–æ–π —Ö–µ–Ω–¥–ª–µ—Ä –∑–∞–ø—É—Å–∫–∞—Ç—å
    dp.include_router(router) # –ü–æ–¥–∫–ª—é—á–∞—é –Ω–∞–±–æ—Ä –ø—Ä–∞–≤–∏–ª (router), –≥–¥–µ –Ω–∞–ø–∏—Å–∞–Ω–æ: –µ—Å–ª–∏ /start ‚Üí –¥–µ–ª–∞–π X, –µ—Å–ª–∏ —Ç–µ–∫—Å—Ç ‚Üí –¥–µ–ª–∞–π Y. üìå –ë–µ–∑ —ç—Ç–æ–≥–æ –±–æ—Ç –±—ã –º–æ–ª—á–∞–ª, –¥–∞–∂–µ –µ—Å–ª–∏ Telegram –ø—Ä–∏—Å—ã–ª–∞–ª —Å–æ–æ–±—â–µ–Ω–∏—è

    await bot(DeleteWebhook(drop_pending_updates=True)) #Telegram, –∑–∞–±—É–¥—å —Å—Ç–∞—Ä—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞–∫–æ–ø–∏–ª–∏—Å—å, –ø–æ–∫–∞ –±–æ—Ç –±—ã–ª –≤—ã–∫–ª—é—á–µ–Ω
    await dp.start_polling(bot) # üî• –í–û–¢ –ó–î–ï–°–¨ –ë–û–¢ –û–ñ–ò–õ. –ó–∞–ø—É—Å–∫–∞—é –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª: —Å–ø—Ä–∞—à–∏–≤–∞—é –µ—Å—Ç—å –Ω–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –µ—Å—Ç—å, —Ç–æ –ø–µ—Ä–µ–¥–∞—é –¥–∏—Å–ø–µ—á–µ—Ä—É

if __name__ == "__main__": # –≠—Ç–æ—Ç —Ñ–∞–π–ª –∑–∞–ø—É—â–µ–Ω –Ω–∞–ø—Ä—è–º—É—é, –∞ –Ω–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω ‚Äî –∑–Ω–∞—á–∏—Ç, –º–æ–∂–Ω–æ —Å—Ç–∞—Ä—Ç–æ–≤–∞—Ç—å
    asyncio.run(main())
